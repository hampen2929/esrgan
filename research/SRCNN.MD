概要-単一画像の超解像のためのディープラーニング手法を提案する。本手法では，低解像度画像と高解像度画像の間のエンドツーエンドのマッピングを直接学習する．このマッピングは、低解像度画像を入力とし、高解像度画像を出力するディープ畳み込みニューラルネットワーク(CNN)として表現される。さらに、従来のスパースコーディングに基づくSR法も、深層畳み込みネットワークとみなすことができることを示す。しかし，従来の手法では各成分を個別に扱うのに対し，我々の手法では全層を共同で最適化する．本手法は、軽量な構造でありながら、最先端の復元品質を発揮し、実用的なオンライン利用のための高速化を実現している。我々は、性能と速度のトレードオフを実現するために、異なるネットワーク構造とパラメータ設定を探求している。さらに、我々のネットワークを拡張し、3つのカラーチャンネルに同時に対応できるようにし、より良い全体的な再構成品質を示す。

単一画像超解像（SR）[20]は、単一の低解像度画像から高解像度画像を復元することを目的とした、コンピュータビジョンの古典的な問題である。この問題は、与えられた低解像度画素に対して複数の解が存在するため、本質的に問題解決が困難である。言い換えれば、この問題は不確定な逆問題であり、その解は一意ではありません。このような問題は、通常、強い事前情報によって解空間を制約することによって緩和される。事前情報を学習するために、最近の最先端の手法は、ほとんどが例題ベースの手法を採用している[46]。これらの手法は、同じ画像の内部類似性を利用するか [5], [13], [16], [19], [47]、または外部の低解像度および高解像度の例題ペアからマッピング関数を学習する [2], [4], [6], [15], [23], [25], [37], [41], [42], [47], [48], [50], [51] のいずれかの方法である。外部の例に基づく手法は、一般的な画像の超解像のために定式化することもできるし、提供された訓練サンプルに応じて、特定の領域のタスク、すなわち顔の幻覚[30], [50]に適合するように設計することもできる。スパース符号化法[49], [50]は、代表的な外部事例に基づくSR法の一つである。この手法では、解答パイプラインにいくつかのステップが含まれている。まず、入力画像から重なり合うパッチが密に切り取られ、前処理（例えば、平均値の減算や正規化）が行われる。これらのパッチは、次に、低解像度の辞書によって符号化される。疎な係数は、高解像度パッチを再構成するための高解像度辞書に渡される。重複した再構成されたパッチは、最終出力を生成するために（例えば、加重平均によって）集約されます。このパイプラインは、ほとんどの外部の例題ベースの手法に共通していますが、辞書の学習と最適化 [2], [49], [50] や効率的なマッピング関数の構築 [25], [41], [42], [47] に特に注意を払っています。しかし、パイプラインの残りのステップは、統一的な最適化フレームワークで最適化されたり、考慮されたりすることはほとんどありませんでした。本論文では、上述のパイプラインが深層畳み込みニューラルネットワーク[27]と同等であることを示す（詳細は3.2節）。本論文では，低解像度画像と高解像度画像の間のマッピングを直接学習する畳み込みニューラルネットワークを考えている．我々の手法は、既存の外部例示ベースのアプローチとは根本的に異なり、パッチ空間をモデル化するための辞書 [41], [49], [50] やマニホールド [2], [4] を明示的に学習しない点である。これらは隠れ層を介して暗黙的に達成されます。さらに、パッチ抽出と集約も畳み込み層として定式化されており、最適化に関与している。我々の手法では、SRパイプライン全体が学習によって完全に得られ、前処理・後処理をほとんど必要としない。

提案モデルを超解像畳み込みニューラルネットワーク(SRCNN)1 と命名した．提案するSRCNNにはいくつかの魅力的な特性がある．第一に，その構造は意図的にシンプルに設計されているにもかかわらず，最新の例題ベースの手法と比較して優れた精度2を提供しています．図 1 に例題を用いた比較を示します．第二に，適度な数のフィルタやレイヤーを用いることで，CPU上でもオンラインでの実用的な高速化を実現している．また，本手法は完全フィードフォワード型であり，使用時に最適化問題を解く必要がないため，多くの例題ベースの手法よりも高速である．第三に、(i)より大規模で多様なデータセットが利用可能な場合、(ii)より大規模で深みのあるモデルが利用可能な場合に、ネットワークの復元品質がさらに向上することが実験で示された。逆に、より大きなデータセットやモデルを使用すると、既存の例題に基づく手法に課題が生じる可能性がある。さらに，提案するネットワークは，3チャンネルのカラー画像を同時に扱うことができ，超解像性能を向上させることができる．

図1. 提案する超解像畳み込みニューラルネットワーク(SRCNN)は，わずか数回の繰り返し学習で二重曲線ベースラインを上回り，スパースコーディングベース手法(SC) [50]を中程度で凌駕する性能を示した．

全体的に見て、本研究の貢献は主に以下の3つの側面である。

1) 画像の超解像のための完全畳み込みニューラルネットワークを提案する。このネットワークは、低解像度画像と高解像度画像の間のエンドツーエンドのマッピングを直接学習し、最適化以上の前処理や後処理をほとんど行わない。2) 本研究では、深層学習に基づくSR法と従来のスパースコーディングに基づくSR法との関係を確立した。この関係は、ネットワーク構造の設計のための指針となる。3) 深層学習が超解像という古典的なコンピュータビジョンの問題に有用であり、良好な品質と速度を達成できることを示す。本研究の予備的なバージョンは以前に発表されている[11]。本研究では，この初期バージョンに重要な点を追加した．第一に，非線形写像層に大きなフィルタサイズを導入することで SRCNN を改良し，非線形写像層を追加することでより深い構造を探索する．第二に，SRCNN を拡張し，YCbCr または RGB 色空間の 3 つの色チャンネルを同時に処理できるようにしました．実験的に，シングルチャンネルネットワークと比較して性能が向上することを実証した．第三に，初期の結果にかなりの新しい解析と直感的な説明を加えた．また, Set5 [2] と Set14 [51] のテスト画像を BSD200 [32] (200枚のテスト画像) に拡張した. さらに、最近発表された多くの手法と比較し、異なる評価基準を用いても、我々のモデルが既存のアプローチよりも優れていることを確認した。

2 関連する研究 
2.1 画像の超解像
画像プリオールによると、単画像超解像アルゴリズムは、予測モデル法、エッジベース法、画像統計法、パッチベース（または例示ベース）法の4つのタイプに分類される。これらの手法は、Yangらの研究[46]で徹底的に調査・評価されている。その中でも，例示ベースの手法[16]，[25]，[41]，[47]は最先端の性能を達成している．内部の例題ベース手法は，自己相似性を利用して，入力画像から例題パッチを生成する．これはGlasnerの研究[16]で最初に提案され、実装を高速化するためにいくつかの改良型[13], [45]が提案されています。外部の例に基づく手法 [2], [4], [6], [15], [37], [41], [48], [49], [50], [51] は、外部データセットから低解像度/高解像度パッチ間のマッピングを学習する。これらの研究は、低・高解像度パッチを関連付けるためのコンパクトな辞書空間やマニホールド空間をどのようにして学習するか、また、そのような空間でどのように表現スキームを行うことができるかについて様々である。Freemanら[14]の先駆的な研究では、辞書は低解像度/高解像度パッチのペアとして直接提示され、入力パッチの最近傍（NN）は低解像度空間で発見され、対応する高解像度パッチは再構成に使用される。Changら[4]は、NN戦略の代替として、マニホールド埋め込み技術を紹介している。Yangらの研究[49], [50]では、上記のNN対応は、より洗練されたスパース符号化定式化へと発展している。カーネル回帰[25]、単純関数[47]、ランダムフォレスト[37]、アンカー付き近傍回帰[41], [42]のような他のマッピング関数が、マッピングの精度と速度をさらに向上させるために提案されている。スパーセコーディングに基づく手法とそのいくつかの改良[41], [42], [48]は、現在では最先端のSR手法の一つである。これらの手法では、パッチが最適化の中心となり、パッチ抽出とアグリゲーションのステップは、前処理と後処理として別々に処理される。SRアルゴリズム[2], [4], [15], [41], [48], [49], [50], [51]の大部分は、グレースケールまたはシングルチャンネル画像の超解像に焦点を当てている。カラー画像の場合、上述の方法では、まず問題を異なる色空間（YCbCrやYUV）に変換し、輝度チャンネルのみにSRを適用している。また、すべてのチャンネルを同時に超解像しようとする試みもある。例えば、Kim and Kwon [25] や Dai et al. しかし、異なるチャンネルのSR性能や、3つのチャンネルすべてを復元する必要性を分析したものはありませんでした。

2.2 畳み込みニューラルネットワーク
畳み込みニューラルネットワーク(CNN)の歴史は数十年前にさかのぼり [27]、最近では画像分類 [18], [26]での成功もあり、ディープCNNが爆発的な人気を博している。また，物体検出 [34], [40], [52]，顔認識 [39]，歩行者検出 [35] などの他のコンピュータビジョン分野にも応用されている．この進歩において、いくつかの要因が中心的に重要である。(i) 最新の強力なGPU上での効率的なトレーニング実装 [26]、(ii) 良好な品質を保ちながら収束を大幅に高速化するRectified Linear Unit (ReLU) [33] の提案 [26]、(iii) 大規模なモデルをトレーニングするための豊富なデータへの容易なアクセス (ImageNet [9] のような) である。我々の手法もこれらの進歩の恩恵を受けている。

2.3 画像復元のためのディープラーニング
 画像の復元に深層学習技術を用いる研究はいくつかある。畳み込みとは対照的に，全層が完全に連結されている多層パーセプトロン(MLP)は，自然画像のノイズ除去[3]やポストデブリのノイズ除去[36]に応用されている．我々の研究とより密接に関連しているのは，畳み込みニューラルネットワークが自然画像のノイズ除去[22]やノイズの多いパターン（汚れや雨）の除去[12]に適用されていることである．これらの復元問題は多かれ少なかれデノイジング駆動型である。Cuiら[5]は、超解像パイプラインに自動エンコーダーネットワークを埋め込むことを提案している[16]。このディープモデルは，カスケードの各層が自己相似性探索プロセスと自動エンコーダーの独立した最適化を必要とするため，特にエンドツーエンドの解決策として設計されているわけではない．これに対して，提案されたSRCNNは，エンドツーエンドのマッピングを最適化します．さらに，SRCNNの方が高速である．このように，SRCNN は定量的に優れた手法であるだけでなく，実用的にも有用な手法である．

 

